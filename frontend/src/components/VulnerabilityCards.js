import React from 'react';

const getSeverityColor = (level) => {
  switch(level?.toUpperCase()) {
    case 'CRITICAL': return 'bg-red-700';
    case 'HIGH': return 'bg-red-500';
    case 'MEDIUM': return 'bg-yellow-500';
    case 'LOW': return 'bg-green-500';
    default: return 'bg-gray-500';
  }
};

export default function VulnerabilityCards({ vulnerabilities, askExplain }) {
  if (!vulnerabilities || vulnerabilities.length === 0) return null;

  return (
    <div className="mt-6 bg-white rounded-lg shadow-md p-6">
      <h2 className="text-xl font-semibold text-gray-900 mb-4">Cartes des Vulnérabilités</h2>
      
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
        {vulnerabilities.map((vuln, index) => (
          <div key={index} className="vulnerability-card border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
            <div className="flex justify-between items-start mb-3">
              <h3 className="text-lg font-semibold text-gray-900">{vuln.type}</h3>
              <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium text-white ${getSeverityColor(vuln.severity)}`}>
                {vuln.severity}
              </span>
            </div>
            
            <p className="text-sm text-gray-600 mb-3">
              <strong>URL:</strong> <span className="truncate block">{vuln.url}</span>
            </p>
            
            <p className="text-sm text-gray-700 mb-4">
              <strong>Payload:</strong> <code className="bg-gray-100 px-1 py-0.5 rounded text-xs">{vuln.payload}</code>
            </p>
            
            <button
              onClick={() => askExplain(`${vuln.type} vulnerability: ${vuln.payload} on ${vuln.url}`)}
              className="btn-explain w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-3 rounded-lg flex items-center justify-center space-x-2 transition-colors"
            >
              <span>Expliquer La Vulnérabilité</span>
            </button>
          </div>
        ))}
      </div>
    </div>
  );
}